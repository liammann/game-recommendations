(function(){function t(t,n){if(e[t])return n(e[t]);$.ajax({url:t,success:function(r){e[t]=r;n(r)},error:function(e,t,n){console.log(e,t,n)},dataType:"text"})}function n(e,t){e.options[t].selected=!0;return}var e={};window.init={ctx:function(e,t){localStorage.getItem("userID")===null?localStorage.setItem("userID","none"):localStorage.getItem("userID")>0?e.userID="&user_id="+localStorage.getItem("userID"):e.userID="";console.log(e.userID);e.data={};e.recom={};e.home=!1;t()}};window.route={home:function(e,n){t("/l/public/games2.json",function(t){e.data.games=JSON.parse(t).games;e.data.games.forEach(function(t,n){e.data.games[n].averageRating=Math.floor(e.data.games[n].averageRating)},e)});e.data.popular={};t("http://localhost:4000/api/v1/games/recommendations?type=most_popular&time_lapse=prev_month"+e.userID,function(t){e.data.popular.month=JSON.parse(t).games;e.data.popular.month.forEach(function(t,n){e.data.popular.month[n].averageRating=Math.floor(e.data.popular.month[n].averageRating)},e)});t("http://localhost:4000/api/v1/games/recommendations?type=most_popular&time_lapse=prev_year"+e.userID,function(t){e.data.popular.year=JSON.parse(t).games;e.data.popular.year.forEach(function(t,n){e.data.popular.year[n].averageRating=Math.floor(e.data.popular.year[n].averageRating)},e)});t("http://localhost:4000/api/v1/games/recommendations?type=most_popular&time_lapse=prev_day"+e.userID,function(t){e.data.popular.day=JSON.parse(t).games;e.data.popular.day.forEach(function(t,n){e.data.popular.day[n].averageRating=Math.floor(e.data.popular.day[n].averageRating)},e)});t("http://localhost:4000/api/v1/games/recommendations?type=top_rated"+e.userID,function(t){e.data.top=JSON.parse(t).games;e.data.top.forEach(function(t,n){e.data.top[n].averageRating=Math.floor(e.data.top[n].averageRating)},e)});t("/l/views/home.html",function(t){e.data.index=0;e.recom.content=t;$(".carousel").carousel({interval:100});e.home=!0;n()})},games:function(e,n){t("/l/public/games.json",function(t){e.data.games=JSON.parse(t).games;e.data.games.forEach(function(t,n){e.data.games[n].averageRating=Math.floor(e.data.games[n].averageRating)},e)});t("/l/views/games.html",function(t){e.data.index=1;console.log(e);e.recom.content=t;n()})},game:function(e,n){t("http://localhost:4000/api/v1/games/"+e.params.name,function(r){e.data.game=JSON.parse(r).game;e.data.game.averageRating=Math.floor(e.data.game.averageRating);e.data.game.releaseDate=(new Date(e.data.game.releaseDate)).toDateString();t("/l/views/game.html",function(t){e.recom.content=t;n()})})},friends:function(e,n){t("/l/public/friends.json",function(r){e.data.friends=JSON.parse(r).user;t("/l/views/friends.html",function(t){e.recom.content=t;n()})})},orders:function(e,n){t("/l/public/orders.json",function(t){e.data.orders=JSON.parse(t).orders;e.data.orders.forEach(function(t,n){e.data.orders[n].orderDate=(new Date(e.data.orders[n].orderDate)).toDateString()},e)});t("/l/views/orders.html",function(t){console.log(e.data);e.recom.content=t;n()})}};window.render={content:function(e,r){t("views/content.html",function(t){var n=Hogan.compile(t),r=n.render(e.data,e.recom);$("#content").empty().append(r);changeActive(e.data.index);if(e.home){document.getElementById("day-btn").addEventListener("click",function(){$(this).parent().find("a").removeClass("selected");$(this).addClass("selected");$("section.pop > div").removeClass("show");$("section.pop > div#day").addClass("show")},!1);document.getElementById("month-btn").addEventListener("click",function(){$(this).parent().find("a").removeClass("selected");$(this).addClass("selected");$("section.pop > div").removeClass("show");$("section.pop > div#month").addClass("show")},!1);document.getElementById("year-btn").addEventListener("click",function(){$(this).parent().find("a").removeClass("selected");$(this).addClass("selected");$("section.pop > div").removeClass("show");$("section.pop > div#year").addClass("show")},!1)}typeof done=="function"&&done(e.data.index)});localStorage.getItem("userID")!=="none"&&n(document.getElementById("logged-in-as"),localStorage.getItem("userID"));document.getElementById("logged-in-as").addEventListener("change",function(){localStorage.setItem("userID",this.value);location.reload()},!1)}};window.done=null})();